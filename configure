#!/bin/bash
# Configure script
# Run once when you unpack source

### Check for GEANT4 install
if [ -z "$G4INSTALL" ]; then
    echo '$G4INSTALL not set.  Please install GEANT4 and set your environment variables.'
    exit 1
fi

type -P python &>/dev/null || { echo "I require python but it's not installed.  Aborting." >&2; exit 1; }

### Create environment files
maus_root_dir=`pwd`
target=`g++ -dumpversion`

cat > env.sh <<EOF
#!/bin/sh
if [ -z "\$MAUS_ROOT_DIR" ]; then
     MAUS_ROOT_DIR=$maus_root_dir
     PATH=\$MAUS_ROOT_DIR/bin:\$PATH
     if [ -z "${LD_LIBRARY_PATH}" ]; then
          LD_LIBRARY_PATH=\$MAUS_ROOT_DIR/lib
     else
          LD_LIBRARY_PATH=\$MAUS_ROOT_DIR/lib:\$LD_LIBRARY_PATH   
     fi

     # scons
     PYTHONPATH=\$MAUS_ROOT_DIR/third_party/scons-2.0.1/lib/scons-2.0.1:\$PYTHONPATH
     PATH=\$MAUS_ROOT_DIR/third_party/scons-2.0.1/bin:\$PATH

     # nose
     PYTHONPATH=\$MAUS_ROOT_DIR/third_party/nose-0.11.3/lib/python:\$PYTHONPATH
     PATH=\$MAUS_ROOT_DIR/third_party/nose-0.11.3/bin:\$PATH 

     # jsoncpp
     PATH=\$MAUS_ROOT_DIR/third_party/jsoncpp-src-0.5.0/bin/linux-gcc-${target}:\$PATH  
     LD_LIBRARY_PATH=\$MAUS_ROOT_DIR/third_party/jsoncpp-src-0.5.0/libs/linux-gcc-${target}:\$LD_LIBRARY_PATH
 
     export MAUS_ROOT_DIR PATH LD_LIBRARY_PATH GLG4DATA RAT_CFLAGS
     echo "SUCCESS: MAUS setup"
else
     echo "ERROR: MAUS already setup"
fi

EOF

#cat > env.csh <<EOF
#!/bin/csh
#setenv MAUS_ROOT_DIR $maus_root_dir
#setenv PATH "\$MAUS_ROOT_DIR/bin:\$PATH"
#if ({\$?LD_LIBRARY_PATH}) then
#  setenv LD_LIBRARY_PATH "\$MAUS_ROOT_DIR/lib:\$LD_LIBRARY_PATH"
#else
#  setenv LD_LIBRARY_PATH "\$MAUS_ROOT_DIR/lib"
#endif
#if ({\$?PYTHONPATH}) then
#  setenv PYTHONPATH "\$MAUS_ROOT_DIR/third_party/scons-2.0.1/lib/scons-2.0.1:\$PYTHONPATH"
#else
#  setenv PYTHONPATH "\$MAUS_ROOT_DIR/third_party/scons-2.0.1/lib/scons-2.0.1"
#endif
#EOF

